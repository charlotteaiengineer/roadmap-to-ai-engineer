<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="generator" content="quarto-1.8.25" />

    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, user-scalable=yes"
    />

    <meta name="dcterms.date" content="2025-10-21" />
    <meta
      name="description"
      content="Kicking off the blog with intent, scope, and how I’ll share progress."
    />

    <title>
      Why I’m Building an AI Engineer Curriculum in Public – prophecy.institute
    </title>
    <style>
      code {
        white-space: pre-wrap;
      }
      span.smallcaps {
        font-variant: small-caps;
      }
      div.columns {
        display: flex;
        gap: min(4vw, 1.5em);
      }
      div.column {
        flex: auto;
        overflow-x: auto;
      }
      div.hanging-indent {
        margin-left: 1.5em;
        text-indent: -1.5em;
      }
      ul.task-list {
        list-style: none;
      }
      ul.task-list li input[type="checkbox"] {
        width: 0.8em;
        margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */
        vertical-align: middle;
      }
    </style>

    <script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
    <script src="../../site_libs/quarto-nav/headroom.min.js"></script>
    <script src="../../site_libs/clipboard/clipboard.min.js"></script>
    <script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
    <script src="../../site_libs/quarto-search/fuse.min.js"></script>
    <script src="../../site_libs/quarto-search/quarto-search.js"></script>
    <meta name="quarto:offset" content="../../" />
    <script src="../../site_libs/quarto-html/quarto.js" type="module"></script>
    <script
      src="../../site_libs/quarto-html/tabsets/tabsets.js"
      type="module"
    ></script>
    <script
      src="../../site_libs/quarto-html/axe/axe-check.js"
      type="module"
    ></script>
    <script src="../../site_libs/quarto-html/popper.min.js"></script>
    <script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
    <script src="../../site_libs/quarto-html/anchor.min.js"></script>
    <link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet" />
    <link
      href="../../site_libs/quarto-html/quarto-syntax-highlighting-7b89279ff1a6dce999919e0e67d4d9ec.css"
      rel="stylesheet"
      id="quarto-text-highlighting-styles"
    />
    <script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
    <link
      href="../../site_libs/bootstrap/bootstrap-icons.css"
      rel="stylesheet"
    />
    <link
      href="../../site_libs/bootstrap/bootstrap-5b4ad623e5705c0698d39aec6f10cf02.min.css"
      rel="stylesheet"
      append-hash="true"
      id="quarto-bootstrap"
      data-mode="light"
    />
    <script id="quarto-search-options" type="application/json">
      {
        "location": "navbar",
        "copy-button": false,
        "collapse-after": 3,
        "panel-placement": "end",
        "type": "overlay",
        "limit": 50,
        "keyboard-shortcut": ["f", "/", "s"],
        "show-item-context": false,
        "language": {
          "search-no-results-text": "No results",
          "search-matching-documents-text": "matching documents",
          "search-copy-link-title": "Copy link to search",
          "search-hide-matches-text": "Hide additional matches",
          "search-more-match-text": "more match in this document",
          "search-more-matches-text": "more matches in this document",
          "search-clear-button-title": "Clear",
          "search-text-placeholder": "",
          "search-detached-cancel-button-title": "Cancel",
          "search-submit-button-title": "Submit",
          "search-label": "Search"
        }
      }
    </script>

    <link rel="stylesheet" href="../../styles.css" />
  </head>

  <body class="nav-fixed quarto-light">
    <div id="quarto-search-results"></div>
    <header id="quarto-header" class="headroom fixed-top">
      <nav class="navbar navbar-expand-lg" data-bs-theme="dark">
        <div class="navbar-container container-fluid">
          <div class="navbar-brand-container mx-auto">
            <a href="../../index.html" class="navbar-brand navbar-brand-logo">
            </a>
            <a class="navbar-brand" href="../../index.html">
              <span class="navbar-title">prophecy.institute</span>
            </a>
          </div>
          <div id="quarto-search" class="" title="Search"></div>
          <button
            class="navbar-toggler"
            type="button"
            data-bs-toggle="collapse"
            data-bs-target="#navbarCollapse"
            aria-controls="navbarCollapse"
            role="menu"
            aria-expanded="false"
            aria-label="Toggle navigation"
            onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }"
          >
            <span class="navbar-toggler-icon"></span>
          </button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
              <li class="nav-item">
                <a class="nav-link" href="../../learning-journey/index.html">
                  <span class="menu-text">Learning Journey</span></a
                >
              </li>
              <li class="nav-item">
                <a class="nav-link" href="../../resources.html">
                  <span class="menu-text">Resources</span></a
                >
              </li>
              <li class="nav-item">
                <a class="nav-link" href="../../blog/index.html">
                  <span class="menu-text">Blog</span></a
                >
              </li>
              <li class="nav-item">
                <a class="nav-link" href="../../projects/index.html">
                  <span class="menu-text">Projects</span></a
                >
              </li>
              <li class="nav-item">
                <a class="nav-link" href="../../about.html">
                  <span class="menu-text">About</span></a
                >
              </li>
            </ul>
          </div>
          <!-- /navcollapse -->
          <div class="quarto-navbar-tools"></div>
        </div>
        <!-- /container-fluid -->
      </nav>
    </header>
    <!-- content -->
    <div
      id="quarto-content"
      class="quarto-container page-columns page-rows-contents page-layout-article page-navbar"
    >
      <!-- sidebar -->
      <!-- margin-sidebar -->
      <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
          <h2 id="toc-title">On this page</h2>

          <ul>
            <li>
              <a
                href="#i-want-to-retrain-to-make-ai-systems"
                id="toc-i-want-to-retrain-to-make-ai-systems"
                class="nav-link active"
                data-scroll-target="#i-want-to-retrain-to-make-ai-systems"
                >I want to retrain to make AI systems</a
              >
            </li>
            <li>
              <a
                href="#my-dream-job"
                id="toc-my-dream-job"
                class="nav-link"
                data-scroll-target="#my-dream-job"
                >My Dream job</a
              >
            </li>
            <li>
              <a
                href="#sample-projects-must-be-in-portfolio"
                id="toc-sample-projects-must-be-in-portfolio"
                class="nav-link"
                data-scroll-target="#sample-projects-must-be-in-portfolio"
                >Sample Projects must be in portfolio</a
              >
            </li>
            <li>
              <a
                href="#must-haves-from-listings"
                id="toc-must-haves-from-listings"
                class="nav-link"
                data-scroll-target="#must-haves-from-listings"
                >Must-Haves from listings</a
              >
            </li>
          </ul>
        </nav>
      </div>
      <!-- main -->
      <main class="content" id="quarto-document-content">
        <header id="title-block-header" class="quarto-title-block default">
          <div class="quarto-title">
            <h1 class="title">
              Why I’m Building an AI Engineer Curriculum in Public
            </h1>
          </div>

          <div>
            <div class="description">
              Kicking off the blog with intent, scope, and how I’ll share
              progress.
            </div>
          </div>

          <div class="quarto-title-meta">
            <div>
              <div class="quarto-title-meta-heading">Published</div>
              <div class="quarto-title-meta-contents">
                <p class="date">October 21, 2025</p>
              </div>
            </div>
          </div>
        </header>

        <section id="i-want-to-retrain-to-make-ai-systems" class="level3">
          <h3
            class="anchored"
            data-anchor-id="i-want-to-retrain-to-make-ai-systems"
          >
            I want to retrain to make AI systems
          </h3>
          <p>
            Why a change in career? I’ve been finding fullstack engineering
            un-impactful and un-fulfilling. Rendering out data on a page;
            designing that page to pixel perfection, and getting millions of
            clicks on buttons I have created doesn’t feel awesome to me.
          </p>
          <p>
            I’m so glad I went down this route and tried it out… however when I
            tell people what they should do with their lives, I tell them to
            study AI and get involved.
          </p>
          <p>
            It is the next technological revolution and I want to be part of it.
            I like how it’s the closest thing to understand the human brain and
            trying to emulate it. I like how we become gods in a way of our own
            simulation. - It’s becoming clearer that we are within a simulation,
            so I want to be a part of the people able to bend the matrix and
            understand it.
          </p>
          <p>
            AI isn’t only interesting for making lots of money. It could do so
            much for us. <a href="https://neuralink.com/">Neuralink</a> comes to
            mind. That’s directly some of the most incredible impactful outcomes
            I’ve seen in my life.
          </p>
          <p>
            In another sense I want to get to see AGI. To understand the human
            mind, truly. I find human intelligence fascinating.
          </p>
        </section>
        <section id="my-dream-job" class="level3">
          <h3 class="anchored" data-anchor-id="my-dream-job">My Dream job</h3>
          <ul>
            <li>Title: AGI Engineer</li>
            <li>Team: The Artificial General Intelligence (AGI) team</li>
            <li>
              Working for a massive well known company like OpenAI, Meta,
              Amazon…
            </li>
            <li>prototype new technology</li>
            <li>Work on creating systems better than the human brain</li>
            <li>
              Proven track record of designing, building, and shipping real-time
              ML products
            </li>
            <li>
              Strong foundation in signal processing, algorithms, and software
              engineering principles
            </li>
          </ul>
          <blockquote class="blockquote">
            <p>
              I need to find the most fascinating stage of training Neural
              Networks to me, then I’ll find the right specialisation.
            </p>
          </blockquote>
        </section>
        <section id="sample-projects-must-be-in-portfolio" class="level3">
          <h3
            class="anchored"
            data-anchor-id="sample-projects-must-be-in-portfolio"
          >
            Sample Projects must be in portfolio
          </h3>
          <p>
            Optimizing the throughput of novel attention mechanisms Comparing
            compute efficiency of different Transformer variants Preparing
            large-scale datasets for efficient model consumption Scaling
            distributed training jobs to thousands of GPUs Designing fault
            tolerance strategies for our training infrastructure Creating
            interactive visualizations of model internals, such as attention
            patterns
          </p>
        </section>
        <section id="must-haves-from-listings" class="level3">
          <h3 class="anchored" data-anchor-id="must-haves-from-listings">
            Must-Haves from listings
          </h3>
          <ul>
            <li><p>Computer Science Degree or equivalent</p></li>
            <li><p>Possess strong programming skills in Python</p></li>
            <li>
              <p>
                Expertise in Python and experience with deep learning frameworks
                (PyTorch preferred)
              </p>
            </li>
            <li><p>Implementing LLM finetuning algorithms, such as RLHF</p></li>
            <li>
              <p>
                Experience with open-source ML toolkits and frameworks (eg.
                PyTorch, TensorFlow, etc)
              </p>
            </li>
            <li>
              <p>
                Have experience with training, evaluating, or monitoring large
                language models
              </p>
            </li>
            <li><p>Language modeling with transformers</p></li>
            <li>
              <p>
                Large-scale ETL Work on high-performance, large-scale ML systems
                Familiarity with GPUs, Kubernetes, and OS internals Experience
                with language modeling using transformer architectures Knowledge
                of reinforcement learning techniques Background in large-scale
                ETL processes Are eager to learn more about machine learning
                research Are working to align state of the art models with human
                values and preferences, understand and interpret deep neural
                networks, or develop new models to support these areas of
                research View research and engineering as two sides of the same
                coin, and seek to understand all aspects of our research program
                as well as possible, to maximize the impact of your insights
                Have ambitious goals for AI safety and general progress in the
                next few years, and you’re working to create the best outcomes
                over the long-term.
              </p>
            </li>
            <li><p>GPUs, Kubernetes, Pytorch, or OS internals</p></li>
            <li><p>Independently lead small research projects</p></li>
            <li>
              <p>
                Conduct research and implement solutions in areas such as model
                architecture, algorithms, data processing, and optimizer
                development
              </p>
            </li>
            <li>
              <p>
                Design, run, and analyze scientific experiments to advance our
                understanding of large language models
              </p>
            </li>
            <li>
              <p>
                Optimize and scale our training infrastructure to improve
                efficiency and reliability
              </p>
            </li>
            <li>
              <p>
                Published work on hallucination prevention, factual grounding,
                or knowledge integration in language models
              </p>
            </li>
            <li><p>Experience with fact-grounding techniques</p></li>
            <li>
              <p>
                Background in developing confidence estimation or calibration
                methods for ML models
              </p>
            </li>
            <li>
              <p>
                A track record of creating and maintaining factual knowledge
                bases
              </p>
            </li>
            <li>
              <p>
                Familiarity with RLHF specifically applied to improving model
                truthfulness
              </p>
            </li>
            <li>
              <p>
                Worked with crowd-sourcing platforms and human feedback
                collection systems
              </p>
            </li>
            <li>
              <p>
                Experience developing evaluations of model accuracy or
                hallucinations
              </p>
            </li>
            <li>
              <p>
                Have industry experience with language model finetuning and
                classifier training
              </p>
            </li>
            <li>
              <p>
                Show proficiency in experimental design and statistical analysis
                for measuring improvements in calibration and accuracy
              </p>
            </li>
            <li>
              <p>
                Care about AI safety and the accuracy and honesty of both
                current and future AI systems
              </p>
            </li>
            <li>
              <p>
                Have experience in data science or the creation and curation of
                datasets for finetuning LLMs
              </p>
            </li>
            <li>
              <p>
                An understanding of various metrics of uncertainty, calibration,
                and truthfulness in model outputs
              </p>
            </li>
            <li>
              <p>
                demonstrable track record of success in delivering new features
                and products
              </p>
            </li>
            <li>
              <p>
                Creating reliable, scalable, and high performance AI products
              </p>
            </li>
            <li>
              <p>
                Knowledge of design or architecture (design patterns,
                reliability and scaling) of new and existing systems experience
              </p>
            </li>
            <li>
              <p>
                development of techniques to minimize hallucinations and enhance
                truthfulness in language models
              </p>
            </li>
            <li>
              <p>
                Design and implement novel data curation pipelines to identify,
                verify, and filter training data for accuracy given the model’s
                knowledge
              </p>
            </li>
            <li>
              <p>
                Develop specialized classifiers to detect potential
                hallucinations or miscalibrated claims made by the mode
              </p>
            </li>
            <li>
              <p>
                Create and maintain comprehensive honesty benchmarks and
                evaluation frameworks
              </p>
            </li>
            <li>
              <p>
                Implement techniques to ground model outputs in verified
                information, such as search and retrieval-augmented generation
                (RAG) systems
              </p>
            </li>
            <li>
              <p>
                Design and deploy human feedback collection specifically for
                identifying and correcting miscalibrated responses
              </p>
            </li>
            <li>
              <p>
                Design and implement prompting pipelines to generate data that
                improves model accuracy and honesty
              </p>
            </li>
            <li>
              <p>
                Develop and test novel RL environments that reward truthful
                outputs and penalize fabricated claims
              </p>
            </li>
            <li>
              <p>
                Create tools to help human evaluators efficiently assess model
                outputs for accuracy
              </p>
            </li>
            <li>
              <p>
                Design, develop, and maintain tokenization systems used across
                Pretraining and Finetuning workflows
              </p>
            </li>
            <li>
              <p>
                Optimize encoding techniques to improve model training
                efficiency and performance
              </p>
            </li>
            <li>
              <p>
                Collaborate closely with research teams to understand their
                evolving needs around data representation
              </p>
            </li>
            <li>
              <p>
                Build infrastructure that enables researchers to experiment with
                novel tokenization approaches
              </p>
            </li>
            <li>
              <p>
                Implement systems for monitoring and debugging
                tokenization-related issues in the model training pipeline
              </p>
            </li>
            <li>
              <p>
                Create robust testing frameworks to validate tokenization
                systems across diverse languages and data types
              </p>
            </li>
            <li>
              <p>
                Identify and address bottlenecks in data processing pipelines
                related to tokenization
              </p>
            </li>
            <li>
              <p>
                Document systems thoroughly and communicate technical decisions
                clearly to stakeholders across teams
              </p>
            </li>
            <li>
              <p>Working with machine learning data processing pipelines</p>
            </li>
            <li>
              <p>Building or optimizing data encodings for ML applications</p>
            </li>
            <li>
              <p>
                Implementing or working with BPE, WordPiece, or other
                tokenization algorithms
              </p>
            </li>
            <li>
              <p>Performance optimization of ML data processing systems</p>
            </li>
            <li><p>Multi-language tokenization challenges and solutions</p></li>
            <li>
              <p>
                Research environments where engineering directly enables
                scientific progress
              </p>
            </li>
            <li>
              <p>Distributed systems and parallel computing for ML workflows</p>
            </li>
            <li>
              <p>
                Large language models or other transformer-based architectures
                (not required)
              </p>
            </li>
            <li>
              <p>
                Profiling our reinforcement learning pipeline to find
                opportunities for improvement Building a system that regularly
                launches training jobs in a test environment so that we can
                quickly detect problems in the training pipeline Making changes
                to our finetuning systems so they work on new model
                architectures Building instrumentation to detect and eliminate
                Python GIL contention in our training code Diagnosing why
                training runs have started slowing down after some number of
                steps, and fixing it Implementing a stable, fast version of a
                new training algorithm proposed by a researcher
              </p>
            </li>
          </ul>
          <p>
            Develop next-generation evaluation frameworks - Move beyond
            traditional benchmarks to create evaluations that capture real-world
            utility
          </p>
          <p>
            Create automated quality assessment pipelines - Build custom
            classifiers to continuously monitor RL transcripts for complex
            issues
          </p>
          <p>
            Build comprehensive training observability systems - Design and
            implement monitoring infrastructure to keep an eye on how model
            behaviors evolve throughout training.
          </p>
          <p>
            Bridge research and production - Partner with research teams to
            translate cutting-edge evaluation techniques into production-ready
            systems, and work with engineering teams to ensure our monitoring
            infrastructure scales with increasingly complex training workflows.
          </p>
          <section id="ideal-working-environment" class="level5">
            <h5 class="anchored" data-anchor-id="ideal-working-environment">
              Ideal working environment
            </h5>
            <ul>
              <li>Work from home, flexible working hours</li>
              <li>Learning days and study days</li>
              <li>Open sharing environment</li>
            </ul>
          </section>
          <section id="listings" class="level4">
            <h4 class="anchored" data-anchor-id="listings">Listings</h4>
            <ul>
              <li>
                <a
                  href="https://job-boards.greenhouse.io/anthropic/jobs/4681526008"
                  >Research Engineer, Pre-training</a
                >
              </li>
              <li>
                <a
                  href="https://job-boards.greenhouse.io/anthropic/jobs/4952079008"
                  >Anthropic - Machine Learning Systems Engineer, Research
                  Tools</a
                >
              </li>
              <li>
                <a
                  href="https://job-boards.greenhouse.io/anthropic/jobs/4532887008"
                  >Anthrophic - [Expression of Interest] Research
                  Scientist/Engineer, Honesty</a
                >
              </li>
              <li>
                <a
                  href="https://job-boards.greenhouse.io/anthropic/jobs/4952051008"
                  >Anthropic - Machine Learning Systems Engineer, RL
                  Engineering</a
                >
              </li>
              <li>
                <a
                  href="https://www.amazon.jobs/en-gb/jobs/3102530/software-development-engineer-ml-agi-customization"
                  >Amazon - Software Development Engineer (ML), AGI
                  Customization</a
                >
              </li>
              <li>
                <a
                  href="https://www.amazon.jobs/en-gb/jobs/3113050/sr-research-engineer-machine-learning-agi-foundations"
                  >Amazon - Sr.&nbsp;Research Engineer, Machine Learning, AGI
                  Foundations</a
                >
              </li>
            </ul>
            <iframe
              width="560"
              height="315"
              src="https://www.youtube.com/embed/FASMejN_5gs?si=ubOyj1Zwey6xvBgo"
              title="YouTube video player"
              frameborder="0"
              allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
              referrerpolicy="strict-origin-when-cross-origin"
              allowfullscreen=""
            >
            </iframe>
          </section>
        </section>
      </main>
      <!-- /main -->
      <script id="quarto-html-after-body" type="application/javascript">
        window.document.addEventListener("DOMContentLoaded", function (event) {
          const icon = "";
          const anchorJS = new window.AnchorJS();
          anchorJS.options = {
            placement: "right",
            icon: icon,
          };
          anchorJS.add(".anchored");
          const isCodeAnnotation = (el) => {
            for (const clz of el.classList) {
              if (clz.startsWith("code-annotation-")) {
                return true;
              }
            }
            return false;
          };
          const onCopySuccess = function (e) {
            // button target
            const button = e.trigger;
            // don't keep focus
            button.blur();
            // flash "checked"
            button.classList.add("code-copy-button-checked");
            var currentTitle = button.getAttribute("title");
            button.setAttribute("title", "Copied!");
            let tooltip;
            if (window.bootstrap) {
              button.setAttribute("data-bs-toggle", "tooltip");
              button.setAttribute("data-bs-placement", "left");
              button.setAttribute("data-bs-title", "Copied!");
              tooltip = new bootstrap.Tooltip(button, {
                trigger: "manual",
                customClass: "code-copy-button-tooltip",
                offset: [0, -8],
              });
              tooltip.show();
            }
            setTimeout(function () {
              if (tooltip) {
                tooltip.hide();
                button.removeAttribute("data-bs-title");
                button.removeAttribute("data-bs-toggle");
                button.removeAttribute("data-bs-placement");
              }
              button.setAttribute("title", currentTitle);
              button.classList.remove("code-copy-button-checked");
            }, 1000);
            // clear code selection
            e.clearSelection();
          };
          const getTextToCopy = function (trigger) {
            const outerScaffold = trigger.parentElement.cloneNode(true);
            const codeEl = outerScaffold.querySelector("code");
            for (const childEl of codeEl.children) {
              if (isCodeAnnotation(childEl)) {
                childEl.remove();
              }
            }
            return codeEl.innerText;
          };
          const clipboard = new window.ClipboardJS(
            ".code-copy-button:not([data-in-quarto-modal])",
            {
              text: getTextToCopy,
            }
          );
          clipboard.on("success", onCopySuccess);
          if (
            window.document.getElementById("quarto-embedded-source-code-modal")
          ) {
            const clipboardModal = new window.ClipboardJS(
              ".code-copy-button[data-in-quarto-modal]",
              {
                text: getTextToCopy,
                container: window.document.getElementById(
                  "quarto-embedded-source-code-modal"
                ),
              }
            );
            clipboardModal.on("success", onCopySuccess);
          }
          var localhostRegex = new RegExp(
            /^(?:http|https):\/\/localhost\:?[0-9]*\//
          );
          var mailtoRegex = new RegExp(/^mailto:/);
          var filterRegex = new RegExp(
            "https:\/\/charlotteaiengineer\.netlify\.app"
          );
          var isInternal = (href) => {
            return (
              filterRegex.test(href) ||
              localhostRegex.test(href) ||
              mailtoRegex.test(href)
            );
          };
          // Inspect non-navigation links and adorn them if external
          var links = window.document.querySelectorAll(
            "a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)"
          );
          for (var i = 0; i < links.length; i++) {
            const link = links[i];
            if (!isInternal(link.href)) {
              // undo the damage that might have been done by quarto-nav.js in the case of
              // links that we want to consider external
              if (link.dataset.originalHref !== undefined) {
                link.href = link.dataset.originalHref;
              }
            }
          }
          function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
            const config = {
              allowHTML: true,
              maxWidth: 500,
              delay: 100,
              arrow: false,
              appendTo: function (el) {
                return el.parentElement;
              },
              interactive: true,
              interactiveBorder: 10,
              theme: "quarto",
              placement: "bottom-start",
            };
            if (contentFn) {
              config.content = contentFn;
            }
            if (onTriggerFn) {
              config.onTrigger = onTriggerFn;
            }
            if (onUntriggerFn) {
              config.onUntrigger = onUntriggerFn;
            }
            window.tippy(el, config);
          }
          const noterefs = window.document.querySelectorAll(
            'a[role="doc-noteref"]'
          );
          for (var i = 0; i < noterefs.length; i++) {
            const ref = noterefs[i];
            tippyHover(ref, function () {
              // use id or data attribute instead here
              let href =
                ref.getAttribute("data-footnote-href") ||
                ref.getAttribute("href");
              try {
                href = new URL(href).hash;
              } catch {}
              const id = href.replace(/^#\/?/, "");
              const note = window.document.getElementById(id);
              if (note) {
                return note.innerHTML;
              } else {
                return "";
              }
            });
          }
          const xrefs = window.document.querySelectorAll("a.quarto-xref");
          const processXRef = (id, note) => {
            // Strip column container classes
            const stripColumnClz = (el) => {
              el.classList.remove("page-full", "page-columns");
              if (el.children) {
                for (const child of el.children) {
                  stripColumnClz(child);
                }
              }
            };
            stripColumnClz(note);
            if (id === null || id.startsWith("sec-")) {
              // Special case sections, only their first couple elements
              const container = document.createElement("div");
              if (note.children && note.children.length > 2) {
                container.appendChild(note.children[0].cloneNode(true));
                for (let i = 1; i < note.children.length; i++) {
                  const child = note.children[i];
                  if (child.tagName === "P" && child.innerText === "") {
                    continue;
                  } else {
                    container.appendChild(child.cloneNode(true));
                    break;
                  }
                }
                if (window.Quarto?.typesetMath) {
                  window.Quarto.typesetMath(container);
                }
                return container.innerHTML;
              } else {
                if (window.Quarto?.typesetMath) {
                  window.Quarto.typesetMath(note);
                }
                return note.innerHTML;
              }
            } else {
              // Remove any anchor links if they are present
              const anchorLink = note.querySelector("a.anchorjs-link");
              if (anchorLink) {
                anchorLink.remove();
              }
              if (window.Quarto?.typesetMath) {
                window.Quarto.typesetMath(note);
              }
              if (note.classList.contains("callout")) {
                return note.outerHTML;
              } else {
                return note.innerHTML;
              }
            }
          };
          for (var i = 0; i < xrefs.length; i++) {
            const xref = xrefs[i];
            tippyHover(
              xref,
              undefined,
              function (instance) {
                instance.disable();
                let url = xref.getAttribute("href");
                let hash = undefined;
                if (url.startsWith("#")) {
                  hash = url;
                } else {
                  try {
                    hash = new URL(url).hash;
                  } catch {}
                }
                if (hash) {
                  const id = hash.replace(/^#\/?/, "");
                  const note = window.document.getElementById(id);
                  if (note !== null) {
                    try {
                      const html = processXRef(id, note.cloneNode(true));
                      instance.setContent(html);
                    } finally {
                      instance.enable();
                      instance.show();
                    }
                  } else {
                    // See if we can fetch this
                    fetch(url.split("#")[0])
                      .then((res) => res.text())
                      .then((html) => {
                        const parser = new DOMParser();
                        const htmlDoc = parser.parseFromString(
                          html,
                          "text/html"
                        );
                        const note = htmlDoc.getElementById(id);
                        if (note !== null) {
                          const html = processXRef(id, note);
                          instance.setContent(html);
                        }
                      })
                      .finally(() => {
                        instance.enable();
                        instance.show();
                      });
                  }
                } else {
                  // See if we can fetch a full url (with no hash to target)
                  // This is a special case and we should probably do some content thinning / targeting
                  fetch(url)
                    .then((res) => res.text())
                    .then((html) => {
                      const parser = new DOMParser();
                      const htmlDoc = parser.parseFromString(html, "text/html");
                      const note = htmlDoc.querySelector("main.content");
                      if (note !== null) {
                        // This should only happen for chapter cross references
                        // (since there is no id in the URL)
                        // remove the first header
                        if (
                          note.children.length > 0 &&
                          note.children[0].tagName === "HEADER"
                        ) {
                          note.children[0].remove();
                        }
                        const html = processXRef(null, note);
                        instance.setContent(html);
                      }
                    })
                    .finally(() => {
                      instance.enable();
                      instance.show();
                    });
                }
              },
              function (instance) {}
            );
          }
          let selectedAnnoteEl;
          const selectorForAnnotation = (cell, annotation) => {
            let cellAttr = 'data-code-cell="' + cell + '"';
            let lineAttr = 'data-code-annotation="' + annotation + '"';
            const selector = "span[" + cellAttr + "][" + lineAttr + "]";
            return selector;
          };
          const selectCodeLines = (annoteEl) => {
            const doc = window.document;
            const targetCell = annoteEl.getAttribute("data-target-cell");
            const targetAnnotation = annoteEl.getAttribute(
              "data-target-annotation"
            );
            const annoteSpan = window.document.querySelector(
              selectorForAnnotation(targetCell, targetAnnotation)
            );
            const lines = annoteSpan.getAttribute("data-code-lines").split(",");
            const lineIds = lines.map((line) => {
              return targetCell + "-" + line;
            });
            let top = null;
            let height = null;
            let parent = null;
            if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
              if (lineIds.length > 1) {
                const lastEl = window.document.getElementById(
                  lineIds[lineIds.length - 1]
                );
                const bottom = lastEl.offsetTop + lastEl.offsetHeight;
                height = bottom - top;
              }
              if (top !== null && height !== null && parent !== null) {
                // cook up a div (if necessary) and position it
                let div = window.document.getElementById(
                  "code-annotation-line-highlight"
                );
                if (div === null) {
                  div = window.document.createElement("div");
                  div.setAttribute("id", "code-annotation-line-highlight");
                  div.style.position = "absolute";
                  parent.appendChild(div);
                }
                div.style.top = top - 2 + "px";
                div.style.height = height + 4 + "px";
                div.style.left = 0;
                let gutterDiv = window.document.getElementById(
                  "code-annotation-line-highlight-gutter"
                );
                if (gutterDiv === null) {
                  gutterDiv = window.document.createElement("div");
                  gutterDiv.setAttribute(
                    "id",
                    "code-annotation-line-highlight-gutter"
                  );
                  gutterDiv.style.position = "absolute";
                  const codeCell = window.document.getElementById(targetCell);
                  const gutter = codeCell.querySelector(
                    ".code-annotation-gutter"
                  );
                  gutter.appendChild(gutterDiv);
                }
                gutterDiv.style.top = top - 2 + "px";
                gutterDiv.style.height = height + 4 + "px";
              }
              selectedAnnoteEl = annoteEl;
            }
          };
          const unselectCodeLines = () => {
            const elementsIds = [
              "code-annotation-line-highlight",
              "code-annotation-line-highlight-gutter",
            ];
            elementsIds.forEach((elId) => {
              const div = window.document.getElementById(elId);
              if (div) {
                div.remove();
              }
            });
            selectedAnnoteEl = undefined;
          };
          // Handle positioning of the toggle
          window.addEventListener(
            "resize",
            throttle(() => {
              elRect = undefined;
              if (selectedAnnoteEl) {
                selectCodeLines(selectedAnnoteEl);
              }
            }, 10)
          );
          function throttle(fn, ms) {
            let throttle = false;
            let timer;
            return (...args) => {
              if (!throttle) {
                // first call gets through
                fn.apply(this, args);
                throttle = true;
              } else {
                // all the others get throttled
                if (timer) clearTimeout(timer); // cancel #2
                timer = setTimeout(() => {
                  fn.apply(this, args);
                  timer = throttle = false;
                }, ms);
              }
            };
          }
          // Attach click handler to the DT
          const annoteDls = window.document.querySelectorAll(
            "dt[data-target-cell]"
          );
          for (const annoteDlNode of annoteDls) {
            annoteDlNode.addEventListener("click", (event) => {
              const clickedEl = event.target;
              if (clickedEl !== selectedAnnoteEl) {
                unselectCodeLines();
                const activeEl = window.document.querySelector(
                  "dt[data-target-cell].code-annotation-active"
                );
                if (activeEl) {
                  activeEl.classList.remove("code-annotation-active");
                }
                selectCodeLines(clickedEl);
                clickedEl.classList.add("code-annotation-active");
              } else {
                // Unselect the line
                unselectCodeLines();
                clickedEl.classList.remove("code-annotation-active");
              }
            });
          }
          const findCites = (el) => {
            const parentEl = el.parentElement;
            if (parentEl) {
              const cites = parentEl.dataset.cites;
              if (cites) {
                return {
                  el,
                  cites: cites.split(" "),
                };
              } else {
                return findCites(el.parentElement);
              }
            } else {
              return undefined;
            }
          };
          var bibliorefs = window.document.querySelectorAll(
            'a[role="doc-biblioref"]'
          );
          for (var i = 0; i < bibliorefs.length; i++) {
            const ref = bibliorefs[i];
            const citeInfo = findCites(ref);
            if (citeInfo) {
              tippyHover(citeInfo.el, function () {
                var popup = window.document.createElement("div");
                citeInfo.cites.forEach(function (cite) {
                  var citeDiv = window.document.createElement("div");
                  citeDiv.classList.add("hanging-indent");
                  citeDiv.classList.add("csl-entry");
                  var biblioDiv = window.document.getElementById("ref-" + cite);
                  if (biblioDiv) {
                    citeDiv.innerHTML = biblioDiv.innerHTML;
                  }
                  popup.appendChild(citeDiv);
                });
                return popup.innerHTML;
              });
            }
          }
        });
      </script>
    </div>
    <!-- /content -->
  </body>
</html>
